<!DOCTYPE html>
<html>
<head>
    <link rel="stylesheet" href="theme.css">
    <script src="theme.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ComicCore | Login</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        /* colors now in theme.css */
  body { margin: 0; padding: 40px 0; font-family: 'Inter', sans-serif; background-color: var(--bg-dark); display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
  .brand-header { color: white; font-size: 28px; font-weight: 700; margin-bottom: 30px; }
  .container { background-color: #ffffff; width: 90%; max-width: 400px; border-radius: 28px; padding: 32px; box-shadow: 0 20px 50px rgba(0,0,0,0.8); box-sizing: border-box; }
  .status-banner { padding: 12px; border-radius: 12px; margin-bottom: 20px; font-size: 14px; display: none; text-align: center; font-weight: 600; }
  .success { background: #e6fffa; color: var(--success-green); border: 1px solid #b2f5ea; }
  .error { background: #fff5f5; color: var(--error-red); border: 1px solid #feb2b2; }
  .header-tabs { display: flex; margin-bottom: 30px; border-bottom: 1px solid #eee; }
  .tab { flex: 1; text-align: center; padding: 12px; cursor: pointer; font-weight: 600; color: #999; }
  .tab.active { color: #000; border-bottom: 3px solid var(--vibrant-orange); }
  .form-content { display: none; }
  .form-content.active { display: block; }
  .input-group { margin-bottom: 16px; position: relative; }
  .input-label { position: absolute; top: -8px; left: 20px; background: white; padding: 0 5px; font-size: 11px; color: var(--vibrant-orange); font-weight: 600; z-index: 1; }
  input { width: 100%; padding: 16px 22px; border: 1.5px solid #ddd; border-radius: 50px; box-sizing: border-box; font-size: 16px; outline: none; }
  .btn { width: 100%; padding: 16px; border: none; border-radius: 50px; font-weight: 700; font-size: 16px; cursor: pointer; background-color: var(--vibrant-orange); color: white; margin-top: 10px; }
</style>
</head>
<body>

<div class="brand-header">ComicCore</div>
<div class="container">
  <div id="status-banner" class="status-banner"></div>
  
  <div class="header-tabs">
    <div id="t-create" class="tab active" onclick="toggle('create')">Create Account</div>
    <div id="t-login" class="tab" onclick="toggle('login')">Log In</div>
  </div>

  <div id="c-create" class="form-content active">
    <div class="input-group"><span class="input-label">Email</span><input type="email" id="reg-email" placeholder="Email"></div>
    <div class="input-group"><input type="password" id="reg-pass" placeholder="Password"></div>
    <button class="btn" onclick="handleAuth('signup')">Get Started</button>
  </div>

  <div id="c-login" class="form-content">
    <div class="input-group"><span class="input-label">Email</span><input type="email" id="log-email" placeholder="Email"></div>
    <div class="input-group"><input type="password" id="log-pass" placeholder="Password"></div>
    <button class="btn" onclick="handleAuth('login')">Sign In</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
  const supabaseClient = supabase.createClient('https://mmycqeejhguzhtzkyjaj.supabase.co', 'sb_publishable_8Du2GAcH5oBeiHWe-1e0Fg_XtSub2QE');

  async function handleAuth(mode) {
    const e = document.getElementById(mode === 'signup' ? 'reg-email' : 'log-email').value;
    const p = document.getElementById(mode === 'signup' ? 'reg-pass' : 'log-pass').value;

    try {
      if (mode === 'signup') {
        const { error } = await supabaseClient.auth.signUp({ email: e, password: p });
        if (error) throw error;
        showStatus("Success! Check your email to verify.", "success");
      } else {
        const { error } = await supabaseClient.auth.signInWithPassword({ email: e, password: p });
        if (error) throw error;
        
        showStatus("Welcome Back! Redirecting...", "success");
        setTimeout(() => { window.location.href = "index.html"; }, 800);
      }
    } catch (err) {
      showStatus(err.message, "error");
    }
  }

  function showStatus(msg, type) {
    const banner = document.getElementById('status-banner');
    banner.innerText = msg;
    banner.className = `status-banner ${type}`;
    banner.style.display = 'block';
  }

  function toggle(mode) {
    const isCreate = mode === 'create';
    document.getElementById('t-create').className = isCreate ? 'tab active' : 'tab';
    document.getElementById('t-login').className = isCreate ? 'tab' : 'tab active';
    document.getElementById('c-create').className = isCreate ? 'form-content active' : 'form-content';
    document.getElementById('c-login').className = isCreate ? 'form-content' : 'form-content active';
  }
</script>
</body>
</html>